# Actions conditionnées au RBAC

### 💡 Actions conditionnées au Rôles

## 📝 Tes notes

Detaille ce que tu as appris ici, sur une page [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Dans une application il arrive souvent que des actions soient conditionnées aux différents utilisateurs. Exemple un `admin` a plus d’options qu’un `user`. Mais un user peut faire des actions sur ses propres `données`.

Nous allons utiliser les fonctions que nous avons maintenant a notre disposition dans le service `autorisation` pour gérer plus finement les actions dans l’application.

Par exemple toutes les fonctions

- `canCreateXXX`
- `isConnectedUserAdmin`
- etc …

## Exercice

**🐶** Dans cet exercice tu vas devoir conditionner l’affichage des boutons d’ajouts

- `Tracker un élément de santé`
- `Tracker une dépense / revenus`

de telle manière que les personnes sur la partie publique ne puissent pas avoir les boutons (sauf le propriétaire ou admin)

Fichiers

- `/components/dashboard/trackers/finance/finance-data-table.tsx`
- `/components/dashboard/trackers/health/health-data-table.tsx`

## Bonus

### 1. 🚀 Masquer des colonnes d’actions

**🐶** Dans cet exercice tu vas devoir conditionner l’affichage des colonnes en fonctions de la permission.

Pour cela tu vas devoir adapté `finance-columns` et `health-columns` pour contenir

- un liste de colonnes pour les `users` standards
- un liste de colonnes pour les `users` avec plus de droits

et conditionner les colonnes dans `finance-data-table` et `health-data-table`

Fais des test dans les differents cas

- un `admin` accède aux données public
- un `user` accède aux données public (d’autres users)
- un `user` accède aux données public (les siennes)

Fichiers

- `/components/dashboard/trackers/finance/finance-columns.tsx`
- `/components/dashboard/trackers/health/health-columns.tsx`
- `/components/dashboard/trackers/finance/finance-data-table.tsx`
- `/components/dashboard/trackers/health/health-data-table.tsx`

### 2. 🚀 Adapter les routes `finance` / `health` publiques

**🐶** Dans cet exercice tu vas devoir adapter les routes publiques pour les `users` n’ayant pas de données.

Au lieu d’afficher `Pas de résultat`, un `admin ou proprietaire` verra un tableau vide et pourra le remplir

## Aller plus loin

📑 Le lien vers la doc clerk rbac [https://clerk.com/docs/references/nextjs/basic-rbac](https://clerk.com/docs/references/nextjs/basic-rbac)

## Ils vont t’aider

- **🐶 Mowgli le Chien** : _Mowgli te guidera dans chaque exercice._
- **🤖 Ash le Robot** : _Ash le Robot te donnera du code utile._
- **🚀 Julia La roquette** : _Julia te donnera des défis supplémentaires._
- **⛏️ Hulk le Marteau** : _Quand du code à supprimer est présent_
- **👨‍✈️ Hugo le chef de projet** : _Va t'aider sur les spécifications du projet_

## 🐜 Feedback

Remplir le formulaire le [formulaire de FeedBack](https://go.mikecodeur.com/cours-next-avis?entry.1912869708=Next%20Mastery&entry.1430994900=8.SAAS%20Entrepreneur&entry.533578441=14-rbac-actions).
