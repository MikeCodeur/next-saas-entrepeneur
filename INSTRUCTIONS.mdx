# Dashboard Layout / Session Account

### ğŸ’¡ Description longue de l'exercice

## ğŸ“ Tes notes

Detaille ce que tu as appris ici,Â surÂ uneÂ pageÂ [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Nous allons maintenant gÃ©rer le `layout` du `dashboard` avec 2 routes simples

- `Account` : Gestion du compte utilisateur
- `Options` : Page dâ€™option pour le `theme`

Ce `layout` contiendra une `SideBar`, un menu Ã  gauche qui contiendra le nom dâ€™utilisateur ou email

## Exercice

Pour simplifier lâ€™exercice, le `layout` du `dashboard` est fournis, il contient un composant `client  <Sidebar />`

```tsx
//app/(app)/layout.tsx
const DashboardLayout = async ({children}: PropsWithChildren) => {
  return (
    <div className="flex h-screen flex-col md:flex-row xl:justify-center">
      <div className="w-full p-4 md:w-64">
        <Sidebar />
      </div>
      <div className="w-full max-w-7xl p-4 pt-8">{children}</div>
    </div>
  )
}
```

Pour le moment `SideBar` contient : USER UNDEFINED

```tsx
// component/dashboard/sidebar.tsx
<p className="hidden grow text-center md:block md:grow-0">
  USER UNDEFINED
</p>
```

ğŸ¶ Dans cet exercice tu vas devoir rÃ©cupÃ©rer le `user` cotÃ© client Ã  partir de la session

Dans un premier temps modifie `components/dashboard/sidebar.tsx`

```tsx
const session = useSession()
console.log('session', session?.data?.user?.name)
```

ğŸ¶ Dans un second temps tu vas devoir ajouter le `sessionProvider` au `RootLayout`

```tsx
//app/layout.tsx
<SessionProvider>{children}</SessionProvider>
```

Fichiers

- `app/layout.tsx`
- `components/dashboard/sidebar.tsx`
- `app/(app)/layout.tsx`

## Bonus

### 1. ğŸš€ Mise Ã  jour de la session cotÃ© client

Pour tester la mise Ã  jour de la session cotÃ© client il va d'abord falloir implÃ©menter la route `account`. Ensuite, une fois que la mise a jour du compte est possible, nous voulons que le nom de lâ€™utilisateur soit mis Ã  jour dans la sidebar en temps rÃ©el (sans avoir Ã  `refresh` la page)

ğŸ¶ Dans un premier temps implÃ©mente le formulaire de modification du compte. Le formulaire est prÃªt, tu nâ€™as plus quâ€™a implÃ©menter lâ€™action

- `app/(app)/account/action.tsx`

```tsx
export const saveUserAction = async (values: UpdateUser) => {
...

```

<aside>
ğŸ’¡

Constate que nous devons encore rafraichir la page pour voir le nom de lâ€™utilisateur Ã  jour dans la sidebar

</aside>

ğŸ¶ Pour mettre Ã  jour la session cotÃ© client, nous allons devoir modifier `app/(app)/account/account-form.tsx` pour forcer la mise a jour de session

```tsx
//app/(app)/account/account-form.tsx
const session = useSession()
session.update()
```

Fichiers

- `app/(app)/account/action.tsx`
- `app/(app)/account/account-form.tsx`

### 2. ğŸš€ Mise Ã  jour utilisateur cotÃ© serveur

Une autre maniÃ¨re plus simple est de fournir le `user` en `props` Ã  la sidebar

```tsx
// app/(app)/layout.tsx
const user = await getUserDal()
<Sidebar user={user} />
```

- ğŸ¶ Adapte le `dashboardLayout` et la `sidebar` dans un premier temps
- ğŸ¶ GÃ¨re la mise Ã  jour du user avec `revalidatePath` dans `action`

```tsx
//app/(app)/account/action.tsx
await updateUser(validateFields.data)
revalidatePath('/account')
```

Fichiers

- `app/(app)/layout.tsx`
- `components/dashboard/sidebar.tsx`
- `app/(app)/account/action.tsx`

### 3. ğŸš€ ImplÃ©mente la page de settings

- ğŸ¶ implÃ©mente la page de settings, elle contiens des buttons pour changer le thÃ¨me

Fichiers

- `app/(app)/setting/page.tsx`

## Ils vont tâ€™aider

- **ğŸ¶ Mowgli le Chien** : _Mowgli te guidera dans chaque exercice._
- **ğŸ¤– Ash le Robot** : _Ash le Robot te donnera du code utile._
- **ğŸš€ Julia La roquette** : _Julia te donnera des dÃ©fis supplÃ©mentaires._
- **â›ï¸ Hulk le Marteau** : _Quand du code Ã  supprimer est prÃ©sent_
- **ğŸ‘¨â€âœˆï¸ Hugo le chef de projet** : _Va t'aider sur les spÃ©cifications du projet_

## ğŸœ Feedback

Remplir le formulaire le [formulaire de FeedBack](https://go.mikecodeur.com/cours-next-avis?entry.1912869708=Next%20Mastery&entry.1430994900=8.SAAS%20Entrepreneur&entry.533578441=04%20Layout-Session-Account).
